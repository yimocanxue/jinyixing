(function($){"use strict";var touch={},touchTimeout;function parentIfText(node){return"tagName"in node?node:node.parentNode}function swipeDirection(x1,x2,y1,y2){var xDelta=Math.abs(x1-x2),yDelta=Math.abs(y1-y2);return xDelta>=yDelta?x1-x2>0?"Left":"Right":y1-y2>0?"Up":"Down"}var longTapDelay=750;function longTap(){touch.last&&Date.now()-touch.last>=longTapDelay&&(touch.el.trigger("longTap"),touch={})}var swipeCounter,longTapTimer,parentChecker=!1,didParentCheck=!1;$(document).ready(function(){var prevEl;$(document.body).bind("touchstart",function(e){swipeCounter=0,e.originalEvent&&(e=e.originalEvent);if(!e.touches||e.touches.length===0)return;var now=Date.now(),delta=now-(touch.last||now);if(!e.touches||e.touches.length===0)return;touch.el=$(parentIfText(e.touches[0].target)),touchTimeout&&clearTimeout(touchTimeout),touch.x1=e.touches[0].pageX,touch.y1=e.touches[0].pageY,touch.x2=touch.y2=0,delta>0&&delta<=250&&(touch.isDoubleTap=!0),touch.last=now,longTapTimer=setTimeout(longTap,longTapDelay
),$.afui.useAutoPressed&&!touch.el.attr("data-ignore-pressed")&&touch.el.addClass("pressed"),prevEl&&$.afui.useAutoPressed&&!prevEl.attr("data-ignore-pressed")&&prevEl[0]!==touch.el[0]&&prevEl.removeClass("pressed"),prevEl=touch.el,parentChecker=!1,didParentCheck=!1}).bind("touchmove",function(e){e.originalEvent&&(e=e.originalEvent),touch.x2=e.touches[0].pageX,touch.y2=e.touches[0].pageY;if(!didParentCheck&&(Math.abs(touch.x2-touch.x1)>5||Math.abs(touch.y2-touch.y1)>5)){var moveX=Math.abs(touch.x2-touch.x1)>5,moveY=Math.abs(touch.y2-touch.y1)>5;didParentCheck=!0,touch.el.trigger("swipeStart",[e]),touch.el.trigger("swipeStart"+swipeDirection(touch.x1,touch.x2,touch.y1,touch.y2),[touch,e]);var parentContainers=touch.el.closest(".swipe, .swipe-reveal, .swipe-x, .swipe-y"),elScroller=touch.el.closest(".x-scroll, .y-scroll, .scroll");parentChecker=touch.el.closest(".swipe, .swipe-reveal").length!==0,elScroller.parent(parentContainers).length!==0?parentChecker=!1:moveX&&touch.el.closest(".swipe-x"
).length!==0?parentChecker=!0:moveY&&touch.el.closest(".swipe-y").length!==0&&(parentChecker=!0)}$.os.android&&didParentCheck&&parentChecker&&e.preventDefault(),clearTimeout(longTapTimer)}).bind("touchend",function(e){e.originalEvent&&(e=e.originalEvent);if(!touch.el)return;$.afui.useAutoPressed&&!touch.el.attr("data-ignore-pressed")&&touch.el.removeClass("pressed");if(touch.isDoubleTap)touch.el.trigger("doubleTap"),touch={};else if((touch.x2>0||touch.y2>0)&&(Math.abs(touch.x1-touch.x2)>30||Math.abs(touch.y1-touch.y2)>30)){touch.el.trigger("swipe");var direction=swipeDirection(touch.x1,touch.x2,touch.y1,touch.y2),scrollDir=".x-scroll",swipeDir=".swipe-x";if(direction.toLowerCase()==="up"||direction.toLowerCase()==="down")scrollDir=".y-scroll",swipeDir=".swipe-y";var swipe=touch.el.closest(swipeDir),scroller=touch.el.closest(scrollDir);(swipe.length===0||scroller.length===0||swipe.find(scroller).length===0)&&touch.el.trigger("swipe"+direction),touch.x1=touch.x2=touch.y1=touch.y2=touch.last=0
}else"last"in touch&&(touch.el.trigger("tap"),touchTimeout=setTimeout(function(){touchTimeout=null,touch.el&&touch.el.trigger("singleTap"),touch={}},250))}).bind("touchcancel",function(){touch.el&&$.afui.useAutoPressed&&!touch.el.attr("data-ignore-pressed")&&touch.el.removeClass("pressed"),touch={},clearTimeout(longTapTimer)})}),["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","tap","singleTap","longTap"].forEach(function(m){$.fn[m]=function(callback){return this.bind(m,callback)}})})(jQuery);