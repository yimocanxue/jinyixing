(function($){"use strict";var activePosition=null,activeEl;function Drawer(){return this}var transitionTypes={push:function(elem,reverse,position){var item=$(elem).closest(".view").children().filter(":not(nav):not(aside)");position=position||activePosition;for(var i=0;i<item.length;i++){var anim=$(item[i]).show().animation();reverse?anim.remove("slide-"+position+"-out").reverse():anim.keep(),anim.run("slide-"+position+"-out")}},cover:function(){},reveal:function(elem,reverse){return this.push(elem,reverse)}};Drawer.prototype={defaultTransition:"slide",defaultAnimation:"cover",isTransitioning:!1,autoHide:function(event){event.preventDefault(),this.hide()},checkViewToClose:function(e){this.autoHide(e)},autoHideCheck:null,selfCheckViewToClose:null,show:function(id,position,animation){if(this.isTransitioning)return;var self=this;activePosition=position==="right"?"right":"left",animation=transitionTypes[animation]?animation:this.defaultAnimation;var currEl=document.getElementById(id.replace("#"
,""));if(!currEl)return;activeEl=currEl;if(currEl.classList.contains("active"))return;this.isTransitioning=!0,this.autoHideCheck=this.autoHide.bind(this),$(currEl).closest(".view").children().filter(":not(nav):not(aside)").off("touchstart",this.autoHideCheck),currEl.classList.add(activePosition);var anim=$(currEl).show(),other=activePosition==="right"?"left":"right";$(currEl).closest(".view").find(".slide-"+other+"-out").length>0&&($(currEl).closest(".view").find(".slide-"+other+"-out").removeClass("slide-"+other+"-out"),$(currEl).closest(".view").find("aside.active, nav.active").removeClass("left right active").hide()),animation!=="reveal"?(anim.css("zIndex","999").animation().run("slide-"+activePosition+"-in").end(function(){this.classList.add("active"),self.isTransitioning=!1}),$("#jui-card-billlist-patch-tab").is(":visible")&&($("#jui-card-billlist-patch-tab").animate({right:"205px"},300,"linear"),$("#jui-card-billlist-patch-card").animate({right:"205px"},300,"linear"))):anim.animation
().run("blank").end(function(){$(this).css("zIndex","999"),this.classList.add("active"),self.isTransitioning=!1}),currEl.activeAnimation=animation,currEl.activePosition=activePosition,currEl.toggled=!0,transitionTypes[animation](currEl,!1),setTimeout(function(){$(currEl).closest(".view").children().filter(":not(nav):not(aside)").on("touchstart",self.autoHideCheck)}),this.selfCheckViewToClose=self.checkViewToClose.bind(this),$(currEl).bind("nestedviewunload",this.selfCheckViewToClose)},hide:function(id,position){if(this.isTransitioning)return;var self=this,currEl=id&&document.getElementById(id.replace("#",""))||activeEl;$(currEl).unbind("nestedviewunload",this.selfCheckViewToClose);if(!currEl||!currEl.toggled)return;$(currEl).closest(".view").children().filter(":not(nav):not(aside)").off("touchstart",this.autoHideCheck);var activePosition=position||currEl.activePosition,anim=$(currEl).animation();currEl.activeAnimation==="reveal"&&$(currEl).css("zIndex","1");var theTransition=currEl.activeAnimation==="reveal"?"blank"
:"slide-"+activePosition+"-in";anim.reverse().reRun(theTransition).end(function(){this.classList.remove("active"),this.classList.remove(activePosition),this.style.display="none",this.style.zIndex="",self.isTransitioning=!1}),transitionTypes[currEl.activeAnimation]&&transitionTypes[currEl.activeAnimation](currEl,!0),currEl.toggled=!1,activeEl=null,$("#jui-card-billlist-patch-tab").is(":visible")&&($("#jui-card-billlist-patch-tab").animate({right:"0px"},450,"linear"),$("#jui-card-billlist-patch-card").animate({right:"0px"},450,"linear"))}},$.afui.drawer=new Drawer,$.afui.registerDataDirective("[data-left-menu]:not([data-menu-close]),[data-right-menu]:not([data-menu-close])",function(item){var $item=$(item),position=$item.attr("data-left-menu")?"left":"right",obj=position==="left"?$item.attr("data-left-menu"):$item.attr("data-right-menu"),transition=$item.attr("data-transition");this.drawer.show(obj,position,transition)}),$.afui.registerDataDirective("[data-menu-close]",function(item){var $item=
$(item),position=null;$item.attr("data-left-menu")&&(position="left"),$item.attr("data-right-menu")&&(position="right");var obj=position==="left"?$item.attr("data-left-menu"):$item.attr("data-right-menu");if(!obj){obj=$(item).closest("nav").prop("id");if(!obj||obj.length===0)obj=$(item).closest(".view").find("nav.active,aside.active").prop("id")}this.drawer.hide(obj,position)})})(jQuery);